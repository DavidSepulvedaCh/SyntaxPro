---
import Layout from "../layouts/Layout.astro";
import Navbar from "../components/Navbar.astro";
import Footer from "../components/Footer.astro";
import productos from "../data/productos.json";
import "../styles/ServicioSuscripcion.scss";

// Agrupar productos por mes
const productosPorMes = productos.reduce(
  (acc, producto) => {
    const mes = producto.mes || 1;
    if (!acc[mes]) {
      acc[mes] = [];
    }
    acc[mes].push(producto);
    return acc;
  },
  {} as Record<number, typeof productos>
);

// Obtener los meses ordenados
const meses = Object.keys(productosPorMes)
  .map(Number)
  .sort((a, b) => a - b);
---

<Layout title="Suscripción de Materiales Digitales - SyntaxPro">
  <Navbar />

  <main class="pdf-viewer-page">
    <div class="pdf-container">
      <div class="pdf-header">
        <h1>Suscripción de Materiales Digitales</h1>
        <p>
          Accede a recursos digitales exclusivos para tu práctica profesional
        </p>
      </div>

      <div class="pdf-viewer">
        <iframe
          src="/SyntaxPro/servicios/Opcion_2.pdf"
          title="Suscripción de Materiales Digitales"
          class="pdf-iframe"></iframe>
      </div>

      <!-- Sección de Productos por Mes -->
      <div class="productos-section">
        <div class="productos-header">
          <h2>Materiales Digitales por Mes</h2>
          <p>
            Descubre nuestros recursos premium organizados en paquetes mensuales
          </p>
        </div>

        <!-- Tabs de Meses -->
        <div class="mes-tabs">
          {
            meses.map((mes, index) => (
              <button
                class={`mes-tab ${index === 0 ? "active" : ""}`}
                data-mes={mes}
              >
                Mes {mes}
              </button>
            ))
          }
        </div>

        <!-- Contenido de cada mes -->
        {
          meses.map((mes, index) => (
            <div
              class={`mes-content ${index === 0 ? "active" : ""}`}
              data-mes-content={mes}
            >
              <div class="mes-info">
                <h3>Paquete del Mes {mes}</h3>
                <p>
                  {productosPorMes[mes].length} producto
                  {productosPorMes[mes].length !== 1 ? "s" : ""} disponible
                  {productosPorMes[mes].length !== 1 ? "s" : ""} en este paquete
                </p>
              </div>

              <div class="carousel-container">
                <button class="carousel-btn prev" data-carousel-prev={mes}>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <polyline points="15 18 9 12 15 6" />
                  </svg>
                </button>

                <div class="carousel-wrapper">
                  <div class="carousel-track" data-carousel-track={mes}>
                    {productosPorMes[mes].map((producto) => (
                      <div class="producto-card">
                        <div class="producto-image">
                          <img src={producto.imagen} alt={producto.nombre} />
                          <div class="producto-badge">Mes {mes}</div>
                        </div>
                        <div class="producto-info">
                          <h3>{producto.nombre}</h3>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>

                <button class="carousel-btn next" data-carousel-next={mes}>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <polyline points="9 18 15 12 9 6" />
                  </svg>
                </button>
              </div>
            </div>
          ))
        }

        <!-- Planes de Suscripción -->
        <div class="suscripcion-planes">
          <h2>Elige tu Plan de Suscripción</h2>
          <p class="planes-subtitle">
            Accede a todos los materiales digitales con actualizaciones
            mensuales
          </p>

          <div class="planes-container">
            <!-- Plan 6 Meses -->
            <div class="plan-card">
              <div class="plan-header">
                <h3>Suscripción<br />6 meses</h3>
                <div class="plan-precio">
                  <span class="precio-valor">$ 400.000</span>
                </div>
              </div>
              <div class="plan-contenido">
                <h4>Incluye:</h4>
                <ul class="plan-beneficios">
                  <li>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Acceso inmediato a plataforma de materiales.
                  </li>
                  <li>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    3 kits de materiales digitales mes a mes (18 kits)
                  </li>
                  <li>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Actualizaciones mensuales automáticas
                  </li>
                </ul>
                <button class="btn-suscribirse" data-plan="6-meses">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="18"
                    height="18"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <circle cx="9" cy="21" r="1"></circle>
                    <circle cx="20" cy="21" r="1"></circle>
                    <path
                      d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"
                    ></path>
                  </svg>
                  Suscribirme
                </button>
              </div>
            </div>

            <!-- Plan Anual -->
            <div class="plan-card plan-destacado">
              <div class="plan-badge">Más Popular</div>
              <div class="plan-header">
                <h3>Suscripción<br />anual</h3>
                <div class="plan-precio">
                  <span class="precio-valor">$ 700.000</span>
                </div>
              </div>
              <div class="plan-contenido">
                <h4>Incluye:</h4>
                <ul class="plan-beneficios">
                  <li>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Acceso inmediato a plataforma de materiales.
                  </li>
                  <li>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    6 kits de materiales digitales mes a mes (36 kits)
                  </li>
                  <li>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Actualizaciones mensuales automáticas
                  </li>
                </ul>
                <button class="btn-suscribirse" data-plan="anual">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="18"
                    height="18"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <circle cx="9" cy="21" r="1"></circle>
                    <circle cx="20" cy="21" r="1"></circle>
                    <path
                      d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"
                    ></path>
                  </svg>
                  Suscribirme
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <Footer />
</Layout>

<script>
  import { initServicioSuscripcion } from "../utils/carousel";

  // Inicializar componentes cuando el DOM esté listo
  document.addEventListener("DOMContentLoaded", () => {
    initServicioSuscripcion();
  });
</script>
